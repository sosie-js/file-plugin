var currentFile="sosie_file.json";function getCurrentFile(){return currentFile}function getFilePluginDir(){return"${currentScript}".replace("/dist/bundle.js","")}function downloadJSON(e,t,r){e=r.compact?JSON.stringify(e):JSON.stringify(e,null,2);var n=new Blob([e]);"filesaver"==r.method?saveAs(n,t,"application/json"):download(n,t,"application/json")}function clearOrOpenUrl(e){var t=prompt("Clear the editor(content will be lost using this url) ?","about:blank");if("about:blank"!=t)if(/https?:\/\//.test(t)){var r={url:t},n=new FormData;n.append("data",JSON.stringify(r)),fetch(getFilePluginDir()+"/dist/corsget.php",{method:"POST",credentials:"same-origin",body:n}).then((function(e){return e.ok?e.text():Promise.reject("Error "+e.status+" : "+e.statusText)}),(function(e){alert(e.message)})).then(async e=>{let t,r;if(null!==(t=/^Error : (\d+)$/.exec(e))){switch(parseInt(t[1])){case 404:r="MISSING DATA";break;case 504:r="FORBIDDEN DOMAIN; check your CORS settings in corsget.php";break;default:r="Unknown Error code "+t}alert(r)}else loadHTML(e)}).catch((function(e){alert("Error : "+e+"(requires corsget.php to be installed)")}))}else alert("Invalid Url");else e.clear()}function openFileHandler(e){var t=this.value.match(/\.([^\.]+)$/)[1].toLowerCase(),r=new RegExp(this.getAttribute("accept").replace(/,/g,"$|^").replace(/\./g,"").toLowerCase());if(console.log('Is "'+t+'" in "'+r+'"?'),t.match(r)){var n=e.target.files;f=n[0],currentFile=f.name,console.info("Open File",currentFile);var i=new FileReader,o=function(e,t){alert(`[${t?"EXPLICIT":"INEXPLICIT"}] ${e.name}: ${e.message}`)};i.onload=(f,function(e){try{var t=e.target.result,r=JSON.parse(t);window.loadJS(r)}catch(e){e instanceof SyntaxError?o(e,!0):o(e,!1)}}),i.readAsText(f)}else alert('Please do not try to upload files with the extension "'+t+'".')}function saveFileInLocal(e){e.save(!0).then(e=>{downloadJSON(e,getCurrentFile(),{method:"filesaver",compact:!1})})}File.init=function(e){let t=getFilePluginDir();console.log("File plugin found in "+t),target="local:"+t,window.hasOwnProperty("loadEditor")?((async()=>{await loadEditor([{"downloadjs@latest":["[src/downloadjs](https://github.com/rndme/download)","../../dist/download.min.js"]},{"file-saver@latest":["[src/file-saver](https://github.com/eligrey/FileSaver.js)","../../dist/FileSaver.min.js"]}],!1,"prod",target)})(),console.log("File plugin initialized ")):alert("You need to load sosie-js/script-loader version 2.3.+ available on github")},SoSIE.register("File");